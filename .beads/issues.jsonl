{"id":"VAULT-024","title":"Security: Add SecureBytes wrapper with deinit zeroise() for key material","description":"Vault key, master key, and share key are held as Data (value type, no zeroing guarantee) for the entire unlocked session. Fix: introduce SecureBytes class wrapper with explicit deinit { zeroise() }. Apply to VaultKey, MasterKey, ShareKey (see A4 newtype issue). Pairs with the VaultKey/MasterKey/ShareKey newtype work.","status":"closed","priority":1,"issue_type":"feature","owner":"r@turek.co","created_at":"2026-02-17T20:36:41.99098-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:08:30.269765-08:00","closed_at":"2026-02-17T22:08:30.269765-08:00","close_reason":"Implemented and tested in commit 07af505"}
{"id":"VAULT-0ei","title":"Preserve VaultView state when returning from settings","description":"VaultView.swift:220-225 clears all files and shows spinner when settings sheet dismissed. Resets scroll position and search state. Should only reload if data actually changed.","status":"closed","priority":2,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-01T15:10:24.14638-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:21:16.005821-08:00","closed_at":"2026-02-01T15:21:16.005821-08:00","close_reason":"Removed destructive files=[] and isLoading=true when settings sheet dismisses. Now calls loadFiles() and checkSharedVaultStatus() without clearing state, preserving scroll position and search text."}
{"id":"VAULT-151","title":"Refactor: DRY — extract writeToBlobPool() from 3 duplicated store methods","description":"VaultStorage.swift:667-760, 788-861, 889-967: The ~40-line block (find blob with space, expand if needed, open FileHandle, write, update cursor, update index) is copy-pasted across storeFile(), storeFiles(), storeFileFromURL(). Copies already diverge in Embrace span reporting. Extract private writeToBlobPool(data:index:) -\u003e BlobWriteResult helper.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:37:40.173615-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:21:32.099907-08:00","closed_at":"2026-02-17T21:21:32.099907-08:00","close_reason":"Closed"}
{"id":"VAULT-1gr","title":"Bug: deleteFileById silently swallows errors with try?","description":"VaultView+Actions.swift:99 (also batchDelete line 36): try? VaultStorage.shared.deleteFile() silently ignores failures. UI removes file from grid and shows 'deleted' toast even when delete failed. Fix: propagate the error — show error toast and keep file in list if delete fails.","status":"closed","priority":1,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-17T20:37:03.640436-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:53:35.973596-08:00","closed_at":"2026-02-17T20:53:35.973596-08:00","close_reason":"Closed"}
{"id":"VAULT-2uc","title":"WS6: Smart empty state walkthrough","status":"closed","priority":2,"issue_type":"feature","owner":"r@turek.co","created_at":"2026-02-08T23:12:53.87975-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:13:43.759023-08:00","closed_at":"2026-02-08T23:13:43.759023-08:00","close_reason":"Closed"}
{"id":"VAULT-3bm","title":"Add serial DispatchQueue for VaultStorage index ops","description":"VaultStorage.loadIndex/saveIndex have no concurrency protection. Add a serial DispatchQueue wrapping index read/write to prevent races between VaultView, ShareSyncManager, BackgroundShareTransferManager.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:00:39.020738-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:13:49.240933-08:00","closed_at":"2026-02-11T22:13:49.240933-08:00","close_reason":"Implemented NSRecursiveLock for VaultStorage index serialization. Compound methods (storeFile, deleteFile, deleteFiles, changeVaultKey, compactBlobs) hold lock across load+modify+save. Read-only methods use public loadIndex wrapper."}
{"id":"VAULT-3fw","title":"Perf: Size guard in SVDFSerializer.buildIncremental() for large vault protection","description":"SVDFSerializer.buildIncremental() copies entire prior SVDF Data (priorData.prefix(fileEntriesEnd)) into output — up to hundreds of MB for large vaults. Short-term fix: add size check, refuse in-memory above threshold and require streaming path. Long-term: rewrite with FileHandle copy ranges.","status":"in_progress","priority":4,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:35.077066-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:32:33.472604-08:00"}
{"id":"VAULT-3j7","title":"WS8: Expandable info sections","status":"closed","priority":2,"issue_type":"feature","owner":"r@turek.co","created_at":"2026-02-08T23:14:37.319753-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:15:26.885314-08:00","closed_at":"2026-02-08T23:15:26.885314-08:00","close_reason":"Closed"}
{"id":"VAULT-3os","title":"Parallel chunk downloads with TaskGroup","description":"downloadSharedVault uses serial for loop for chunk downloads (N+1 pattern). Use TaskGroup with concurrency limit of 4 matching upload pattern.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:01:09.550757-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:47:31.977088-08:00","closed_at":"2026-02-11T22:47:31.977088-08:00","close_reason":"Closed"}
{"id":"VAULT-3q6","title":"Perf: Spatial grid index for drag hit-testing in PhotosGridView/FilesGridView","description":"PhotosGridView.swift:139-141 (also FilesGridView.swift:162-163): cellId(at:) does O(n) linear scan through cellFrames on every drag .onChanged event. Fix: build [[UUID?]] spatial grid index from cellFrames once when grid layout changes; O(1) lookup by computed row/col.","status":"open","priority":3,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:23.654202-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:38:23.654202-08:00"}
{"id":"VAULT-4bd","title":"Replace full-screen blocking spinner with skeleton view","description":"VaultView.swift:128-129 shows ProgressView('Loading vault...') blocking the entire view. Replace with skeleton grid cells using .redacted(reason: .placeholder) matching PhotosGridView 3-column layout.","status":"closed","priority":1,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-01T15:10:14.564613-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:16:55.607803-08:00","closed_at":"2026-02-01T15:16:55.607803-08:00","close_reason":"Replaced ProgressView('Loading vault...') blocking spinner with a 3-column skeleton grid of 12 placeholder tiles using .redacted(reason: .placeholder). Matches PhotosGridView layout so transition is seamless."}
{"id":"VAULT-4fm","title":"VaultStorage integration tests with temp directory","description":"Zero tests for core storage path. Test store/list/retrieve/delete round-trip, changeVaultKey verification, index Codable round-trips using temp directory.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:01:06.187354-08:00","created_by":"ehmo","updated_at":"2026-02-13T16:55:07.210906-08:00","closed_at":"2026-02-13T16:55:07.210906-08:00","close_reason":"Implemented VaultStorageIntegrationTests (10 tests) and PatternSetupCoordinator with PatternSetupCoordinatorTests (6 tests). All 165 tests pass."}
{"id":"VAULT-52z","title":"Tests: EncryptedBlobTests — blob cursor/offset correctness","description":"EncryptedBlob.swift has zero unit tests. Manages raw file I/O at specific offsets in pre-allocated random-data blobs. Write tests: read/write at specific offsets, cursor persistence across FileHandle open/close cycles, expansion creates new blob, boundary writes (at end of blob). Use temp files.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:36:51.698585-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:12:52.623998-08:00","closed_at":"2026-02-17T21:12:52.623998-08:00","close_reason":"Closed"}
{"id":"VAULT-59m","title":"Security: performLoadIndex silently returns empty vault on wrong key or corruption","description":"VaultStorage.performLoadIndex() catches decryption failure and returns a brand-new empty VaultIndex instead of throwing. Wrong pattern shows empty vault. Corrupted index is silently replaced. No error propagated to caller. Fix: throw VaultError.decryptionFailed on index decrypt failure. Update call sites in AppState to distinguish wrong-key from corruption. VaultStorage.swift:447-473.","status":"closed","priority":0,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-17T20:36:29.643288-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:45:17.468762-08:00","closed_at":"2026-02-17T20:45:17.468762-08:00","close_reason":"Closed"}
{"id":"VAULT-5vs","title":"WS1: Date-grouped file grid","status":"closed","priority":1,"issue_type":"feature","owner":"r@turek.co","created_at":"2026-02-08T23:02:34.567194-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:05:08.571175-08:00","closed_at":"2026-02-08T23:05:08.571175-08:00","close_reason":"Closed"}
{"id":"VAULT-624","title":"Bug: checkPhraseAvailability returns .success on network error — confusing failure later","description":"ShareUploadManager.swift:96-98: network errors return .success(()), allowing user to proceed with a possibly-claimed phrase. Results in a generic 'upload failed' with no explanation. Fix: distinguish network error from 'phrase available' — surface retryable error state ('Can't verify phrase — check connection') before allowing user to proceed.","status":"closed","priority":2,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-17T20:37:51.296295-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:17:19.364547-08:00","closed_at":"2026-02-17T21:17:19.364547-08:00","close_reason":"Closed"}
{"id":"VAULT-6mj","title":"Add Reduce Motion support","description":"WelcomeView pulsating animation runs .repeatForever() without checking accessibilityReduceMotion. Spring animations on PatternLockView error also ignore preference. Affects WelcomeView.swift:24, ContentView.swift:19-21, PatternLockView.swift:83.","status":"closed","priority":0,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-01T15:10:09.570742-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:14:33.058783-08:00","closed_at":"2026-02-01T15:14:33.058783-08:00","close_reason":"Added @Environment accessibilityReduceMotion checks to: WelcomeView pulsating animation, ContentView state transitions, PatternLockView error spring animation, FullScreenPhotoViewer drag-to-dismiss spring, OnboardingView step transitions. All decorative animations now disabled when Reduce Motion is on."}
{"id":"VAULT-6qy","title":"Unit tests for ShareLinkEncoder and RecoveryPhraseGenerator","description":"Zero tests for share link encode/decode and recovery phrase generation/validation. Write round-trip tests, edge cases, validation category tests.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:01:00.84282-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:20:24.370981-08:00","closed_at":"2026-02-11T22:20:24.370981-08:00","close_reason":"136 tests passing: PatternValidator (20), PatternSerializer (29), KeyDerivation (11), ShareLinkEncoder (20), RecoveryPhraseGenerator (19). Also fixed analyzePattern crash on empty patterns."}
{"id":"VAULT-6zv","title":"WS11: Premium hero card + inline limits","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-08T23:19:24.166904-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:19:28.910387-08:00","closed_at":"2026-02-08T23:19:28.910387-08:00","close_reason":"Implemented and build verified"}
{"id":"VAULT-70t","title":"Tests: SecureDeleteTests — verify 3-pass overwrite actually executes","description":"SecureDelete.swift has zero unit tests. The 3-pass overwrite (zeros, ones, random) is a core app promise. Write SecureDeleteTests: create temp file, run secureDelete, verify file doesn't exist after, verify overwrite passes executed (can check that file bytes changed). Low-medium effort.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:36:51.576514-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:12:52.607805-08:00","closed_at":"2026-02-17T21:12:52.607805-08:00","close_reason":"Closed"}
{"id":"VAULT-7ax","title":"WS9: Settings reorganization","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-08T23:15:32.083473-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:16:11.977729-08:00","closed_at":"2026-02-08T23:16:11.977729-08:00","close_reason":"Closed"}
{"id":"VAULT-7up","title":"Refactor: Extract VaultViewModel from VaultView mega-view","description":"VaultView.swift has ~30 @State properties across 525 lines + 5 extension files. Import state, batch selection, share upload state, paywall, fan menu all mixed together. Views call VaultStorage.shared, ShareUploadManager.shared, BackgroundShareTransferManager.shared directly. Extract VaultViewModel: ObservableObject for non-UI logic. Combine with VaultImportCoordinator extraction (C10).","status":"open","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:37:29.030828-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:37:29.030828-08:00"}
{"id":"VAULT-8bz","title":"Security: Silent secure delete failure — plaintext persists in blob on RNG failure","description":"In VaultStorage.deleteFile() and deleteFiles(), if CryptoEngine.generateRandomBytes() returns nil, the index marks the entry deleted but the blob region is NOT overwritten. Sensitive plaintext persists. Fix: throw on RNG failure, roll back the index change. Also affects secureOverwrite() and createRandomBlob(). VaultStorage.swift:1098-1099, 1146-1148, 1402-1405.","status":"closed","priority":0,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-17T20:36:29.510234-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:45:17.454397-08:00","closed_at":"2026-02-17T20:45:17.454397-08:00","close_reason":"Closed"}
{"id":"VAULT-8pj","title":"Task.detached for handleCapturedImage and deleteFileById","description":"VaultView.handleCapturedImage and deleteFileById use Task{} inheriting MainActor. Encryption/IO runs on main thread causing UI freeze. Use Task.detached.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:01:11.130397-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:04:43.406181-08:00","closed_at":"2026-02-11T22:04:43.406181-08:00","close_reason":"Closed"}
{"id":"VAULT-8wd","title":"WS10: Toolbar storage indicator","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-08T23:19:23.126627-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:19:28.885433-08:00","closed_at":"2026-02-08T23:19:28.885433-08:00","close_reason":"Implemented and build verified"}
{"id":"VAULT-8xb","title":"Perf: Deprecate and audit encryptStreaming(fileURL:) — misleading non-streaming method","description":"CryptoEngine.swift:407: encryptStreaming(fileURL:) reads chunks but accumulates entire output in a single Data (50MB file = 50MB Data). True streaming variant encryptFileStreamingToHandle() exists. Fix: mark encryptStreaming(fileURL:) @available(*, deprecated, renamed: encryptFileStreamingToHandle). Audit and redirect all call sites.","status":"in_progress","priority":4,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:34.958583-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:32:33.377899-08:00"}
{"id":"VAULT-9hn","title":"Remove double encryption layer in share upload","description":"Files are encrypted per-file with shareKey at BackgroundShareTransferManager:90, then the entire JSON blob is encrypted again with the same shareKey at CloudKitSharingManager:131. The outer encryption adds latency and ~28 bytes overhead per AES-GCM seal. Remove the outer encryption or the per-file encryption — not both.","status":"closed","priority":2,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-01T16:40:28.481677-08:00","created_by":"ehmo","updated_at":"2026-02-01T16:43:54.002105-08:00","closed_at":"2026-02-01T16:43:54.002105-08:00","close_reason":"Removed outer AES-GCM encryption in uploadSharedVault and syncSharedVault (files already individually encrypted). Bumped manifest version to 2. Download paths handle both v1 (outer decrypt) and v2 (raw passthrough) for backward compat."}
{"id":"VAULT-9qr","title":"WS7: Benefit-led copy rewrites","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-08T23:13:48.913761-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:14:32.864301-08:00","closed_at":"2026-02-08T23:14:32.864301-08:00","close_reason":"Closed"}
{"id":"VAULT-9tu","title":"WS2: Affordance + batch select mode","status":"closed","priority":1,"issue_type":"feature","owner":"r@turek.co","created_at":"2026-02-08T23:05:16.802169-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:07:30.66979-08:00","closed_at":"2026-02-08T23:07:30.66979-08:00","close_reason":"Closed"}
{"id":"VAULT-ak1","title":"Bug: checkSharedVaultStatus inflates open count on every view appearance","description":"VaultView+SharedVault.swift:91-102: open count incremented every time checkSharedVaultStatus() runs — triggered by loadVault() in .task and onChange(of: showingSettings). Navigating away/back burns through maxOpens. Fix: add a flag reset on vault lock, increment open count only once per unlock session.","status":"closed","priority":1,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-17T20:37:03.50685-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:53:35.989915-08:00","closed_at":"2026-02-17T20:53:35.989915-08:00","close_reason":"Closed"}
{"id":"VAULT-akj","title":"Batch storeFiles() method mirroring deleteFiles","description":"storeFile loads/saves index per call. During 20-photo import = 40 crypto ops + 40 disk writes. Add storeFiles(batch:) that loads index once, appends all, saves once.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:01:15.440696-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:28:19.159831-08:00","closed_at":"2026-02-11T22:28:19.159831-08:00","close_reason":"Closed"}
{"id":"VAULT-axv","title":"Add interactiveDismissDisabled to multi-step sheet flows","description":"ChangePatternView, RecoveryPhraseInputView can be accidentally dismissed by swiping down mid-flow. Add .interactiveDismissDisabled() when user is partway through multi-step process.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-01T15:10:20.675958-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:19:39.355315-08:00","closed_at":"2026-02-01T15:19:39.355315-08:00","close_reason":"Added .interactiveDismissDisabled() to ChangePatternView, CustomRecoveryPhraseInputView, and RecoveryPhraseInputView sheets. All have explicit Cancel/Done buttons, preventing accidental swipe-dismiss during multi-step flows."}
{"id":"VAULT-bad","title":"Security: Streaming decrypt XOR nonce computed but discarded — no chunk ordering enforcement","description":"CryptoEngine.swift:331-334 (also 377-379, 486-488): XOR-derived nonce is computed and validated but then discarded. sealedBox nonce comes from combined data. AES-GCM auth ensures no tampering but doesn't prevent chunk reordering. Fix: after decryption, verify sealedBox.nonce matches expected XOR nonce; throw tamperedChunk if mismatch. Pair with chunk-swap test.","status":"closed","priority":1,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-17T20:37:16.40399-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:53:36.007137-08:00","closed_at":"2026-02-17T20:53:36.007137-08:00","close_reason":"Closed"}
{"id":"VAULT-bas","title":"Reduce artificial unlock delay floor","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-29T14:08:41.076025-08:00","created_by":"ehmo","updated_at":"2026-01-29T14:10:23.066656-08:00","closed_at":"2026-01-29T14:10:23.066656-08:00","close_reason":"Closed"}
{"id":"VAULT-bmq","title":"Tests: CloudKitSharingClient mock + ShareSyncManager tests","description":"CloudKitSharingManager and ShareSyncManager have zero unit tests. The non-CloudKit logic (sync state machine, job transitions, conflict resolution) can be tested without iCloud. Extract CloudKitSharingClient protocol, create a mock, test ShareSyncManager orchestration in isolation. CloudKitSharingManager itself stays as a thin adapter.","status":"in_progress","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:02.722043-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:29:02.740231-08:00","dependencies":[{"issue_id":"VAULT-bmq","depends_on_id":"VAULT-esf","type":"blocks","created_at":"2026-02-17T20:38:44.858855-08:00","created_by":"ehmo"}]}
{"id":"VAULT-bzt","title":"Move listFiles + thumbnail decrypt off Main Actor","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T14:08:40.684842-08:00","created_by":"ehmo","updated_at":"2026-01-29T14:09:43.214355-08:00","closed_at":"2026-01-29T14:09:43.214355-08:00","close_reason":"Closed"}
{"id":"VAULT-c7n","title":"Share vault via link (universal links + deep link handling)","description":"Add ability to share vaults via copyable links instead of just phrases. Link format: https://vaultaire.app/s#[encoded-phrase]. BIP39 word indices packed into custom base58-like encoding (no ambiguous chars). Fragment-only so phrase never hits server. Infrastructure: AASA file, static landing page, Associated Domains entitlement, onOpenURL handler, SharedVaultInviteView, ShareLinkGenerator, Copy Link + share sheet button on share screen. One-time use (claimed flag). Revoked links show error screen. Deep link bypasses pattern screen into shared vault onboarding.","status":"in_progress","priority":1,"issue_type":"feature","owner":"r@turek.co","created_at":"2026-02-10T13:41:30.359417-08:00","created_by":"ehmo","updated_at":"2026-02-10T13:41:35.293445-08:00"}
{"id":"VAULT-cxk","title":"Refactor: Replace VaultStorage print() with Logger (os.log)","description":"VaultStorage.swift has 50+ #if DEBUG print(...) calls with emoji prefixes. All other files use Logger (os.log). Replace with: private let logger = Logger(subsystem: Bundle.main.bundleIdentifier\\!, category: 'storage'). Enables production log-level filtering, Instruments integration, and category filtering.","status":"closed","priority":3,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:13.270455-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:33:48.47654-08:00","closed_at":"2026-02-17T21:33:48.47654-08:00","close_reason":"Closed"}
{"id":"VAULT-czs","title":"Eliminate redundant index+key derivation in share upload loop","description":"BackgroundShareTransferManager:89 calls retrieveFile(id:with:) per file, which internally calls loadIndex()+getMasterKey() each time. The index and masterKey are already available at lines 81-82. Add a VaultStorage method to retrieve file content with pre-loaded index and masterKey.","status":"closed","priority":1,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-01T16:40:23.51007-08:00","created_by":"ehmo","updated_at":"2026-02-01T16:41:19.426369-08:00","closed_at":"2026-02-01T16:41:19.426369-08:00","close_reason":"Added retrieveFileContent(entry:index:masterKey:) to VaultStorage. Upload loop now reuses pre-loaded index and masterKey instead of re-deriving per file. Eliminates N redundant loadIndex+PBKDF2 calls."}
{"id":"VAULT-d3u","title":"Add unit tests for savePattern error paths via protocol-based mocking","description":"PatternSetupView.savePattern() and saveCustomRecoveryPhrase() now show error alerts on failure, but the error paths cannot be unit tested without protocol-based mocking of VaultStorage, KeyDerivation, and RecoveryPhraseManager. Create protocols for these dependencies, inject them into PatternSetupView, and write tests for: key derivation failure, vault save failure, recovery phrase save failure, and duplicate pattern detection.","status":"closed","priority":3,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-13T15:21:10.166643-08:00","created_by":"ehmo","updated_at":"2026-02-13T16:55:07.212839-08:00","closed_at":"2026-02-13T16:55:07.212839-08:00","close_reason":"Implemented VaultStorageIntegrationTests (10 tests) and PatternSetupCoordinator with PatternSetupCoordinatorTests (6 tests). All 165 tests pass."}
{"id":"VAULT-d6k","title":"Refactor: VaultKey/MasterKey/ShareKey newtypes — prevent wrong-key misuse","description":"All key types are untyped Data, passed through dozens of function signatures. A wrong key compiles silently. Introduce VaultKey, MasterKey, ShareKey as struct newtypes: struct VaultKey { let rawBytes: Data }. Breaking at all call sites but compiler-enforced. VaultStorage, ShareSyncManager, ShareUploadManager, BackgroundShareTransferManager, ImportIngestor all affected.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:36:42.120811-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:08:30.272674-08:00","closed_at":"2026-02-17T22:08:30.272674-08:00","close_reason":"Implemented and tested in commit 07af505"}
{"id":"VAULT-dkt","title":"Unit tests for PatternValidator, PatternSerializer, KeyDerivation","description":"Zero tests for security-critical pure-logic modules. Write comprehensive tests: pattern validation rules, serialization determinism, key fingerprint, normalization.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:00:59.081126-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:20:24.369378-08:00","closed_at":"2026-02-11T22:20:24.369378-08:00","close_reason":"136 tests passing: PatternValidator (20), PatternSerializer (29), KeyDerivation (11), ShareLinkEncoder (20), RecoveryPhraseGenerator (19). Also fixed analyzePattern crash on empty patterns."}
{"id":"VAULT-dwo","title":"Tests: Share round-trip integration test — owner stores, recipient decrypts, verify bytes","description":"Maestro share flows test UI only, not data correctness. Write integration test: share a known file with a known phrase (two VaultStorage instances, different vault keys), import as recipient, verify decrypted bytes match original. This is the most valuable missing integration test.","status":"in_progress","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:13.145147-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:29:02.930487-08:00"}
{"id":"VAULT-egh","title":"Add error feedback when pattern confirmation fails","description":"PatternSetupView.swift:374-379 silently resets when patterns don't match during onboarding confirm step. No text error, no shake, no feedback. Compare to PatternLockView which does show error message.","status":"closed","priority":2,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-01T15:10:19.667722-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:18:59.251148-08:00","closed_at":"2026-02-01T15:18:59.251148-08:00","close_reason":"Added visible error message ('Patterns don't match. Try again.') with icon when pattern confirmation fails in PatternSetupView. Auto-clears after 2.5s. Pairs with existing haptic error feedback."}
{"id":"VAULT-esf","title":"Refactor: Protocol + environment injection for VaultStorage, CloudKitSharingManager, SubscriptionManager","description":"~17 singletons make testing and lifecycle management difficult. First priority: define protocols for VaultStorage (VaultStorageProtocol), CloudKitSharingManager (CloudKitSharingClient), SubscriptionManager (SubscriptionManagerProtocol). Inject via SwiftUI Environment or constructor. Enables mocking in tests. High effort, high payoff.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:37:51.16305-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:28:57.140175-08:00","closed_at":"2026-02-17T22:28:57.140175-08:00","close_reason":"Protocols + constructor injection in commit 896cfc5"}
{"id":"VAULT-fat","title":"Refactor: Extract VaultIndexManager from VaultStorage God Object","description":"VaultStorage.swift is 1640 lines with 7 nested types, owning blob I/O, index CRUD+migration, multi-blob pool, file store/retrieve/delete, vault destruction, and key management. First split: extract VaultIndexManager (index load/save/migrate/nested types VaultIndex, VaultFileEntry, BlobDescriptor, ShareRecord, SharePolicy). Medium effort, low risk. Prerequisite for @MainActor migration (A9).","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:37:28.776565-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:17:28.562364-08:00","closed_at":"2026-02-17T22:17:28.562364-08:00","close_reason":"Extracted in commit 3d66c85"}
{"id":"VAULT-g0q","title":"Consolidate duplicate PBKDF2 into KeyDerivation","description":"CloudKitSharingManager.deriveShareKey() duplicates KeyDerivation.deriveShareKey() - same 800K iterations, same salt. Consolidate into single implementation in KeyDerivation.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:00:43.110046-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:04:43.407462-08:00","closed_at":"2026-02-11T22:04:43.407462-08:00","close_reason":"Closed"}
{"id":"VAULT-gwd","title":"Refactor: Extract VaultImportCoordinator from VaultView+Actions","description":"VaultView+Actions.swift has ~600 lines of business logic (performPhotoImport lines 318-503, performFileImport 582-707): file I/O, encryption, thumbnail generation, progress tracking, error accumulation, subscription limits, UI state. Extract to VaultImportCoordinator. Combine with VaultViewModel extraction (VAULT-7up).","status":"open","priority":3,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:13.403743-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:38:13.403743-08:00"}
{"id":"VAULT-i0q","title":"WS4: Milestone celebrations","status":"closed","priority":2,"issue_type":"feature","owner":"r@turek.co","created_at":"2026-02-08T23:11:01.168117-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:11:38.281979-08:00","closed_at":"2026-02-08T23:11:38.281979-08:00","close_reason":"Closed"}
{"id":"VAULT-i5m","title":"Refactor: Clarify BackgroundShareTransferManager vs ShareUploadManager split","description":"Both BSTM (938 lines) and SUM (1183 lines) manage upload, pending state, background task registration. Architecture decision: BSTM = download/import only, SUM = upload only. Strip all upload logic from BSTM. Reduce duplication, eliminate ambiguity about which manager to use.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:37:40.037739-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:31:00.75828-08:00","closed_at":"2026-02-17T22:31:00.75828-08:00","close_reason":"Deferred — BSTM upload methods aren't called externally (only download/import used). Low risk as-is. Cleanup can be done in a future session."}
{"id":"VAULT-ihl","title":"Security: Share key uses fixed salt for all users — per-phrase salt needed","description":"KeyDerivation.deriveKey(from:) uses literal 'vault-share-v1-salt' as PBKDF2 salt for all share keys. Standard practice: per-phrase salt. Fix: SHA256('vault-share-v1-' + normalized_phrase) as salt. Breaking change for all existing shares — requires migration on first open after upgrade.","status":"closed","priority":1,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-17T20:36:29.767098-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:08:30.271306-08:00","closed_at":"2026-02-17T22:08:30.271306-08:00","close_reason":"Implemented and tested in commit 07af505"}
{"id":"VAULT-iky","title":"Pre-decode UIImage thumbnails off main thread","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T14:08:40.882358-08:00","created_by":"ehmo","updated_at":"2026-01-29T14:09:43.359351-08:00","closed_at":"2026-01-29T14:09:43.359351-08:00","close_reason":"Closed"}
{"id":"VAULT-im7","title":"Tests: Nonce chunk-swap test — paired with streaming decrypt nonce enforcement fix","description":"Once VAULT-bad (XOR nonce verification in streaming decrypt) is fixed: add test that encrypts a 2-chunk file, swaps the chunks in the byte stream, and verifies decryption throws tamperedChunk. Blocked on VAULT-bad.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:41.063484-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:12:52.593348-08:00","closed_at":"2026-02-17T21:12:52.593348-08:00","close_reason":"Closed","dependencies":[{"issue_id":"VAULT-im7","depends_on_id":"VAULT-bad","type":"blocks","created_at":"2026-02-17T20:38:44.655981-08:00","created_by":"ehmo"}]}
{"id":"VAULT-iym","title":"Replace custom header bars with NavigationStack toolbar","description":"ChangePatternView, RecoveryPhraseInputView, CustomRecoveryPhraseInputView build custom HStack headers instead of NavigationStack with .toolbar. Breaks iOS patterns, no blur/scroll behavior.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-01T15:10:22.218731-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:20:45.51791-08:00","closed_at":"2026-02-01T15:20:45.51791-08:00","close_reason":"Replaced custom HStack header bars with NavigationStack + .toolbar in: RecoveryPhraseInputView, ChangePatternView, CustomRecoveryPhraseInputView, and RecoveryPhraseView. All now use standard .navigationTitle/.navigationBarTitleDisplayMode(.inline) with .cancellationAction or .confirmationAction toolbar items."}
{"id":"VAULT-kqn","title":"Eagerly init VaultStorage singleton at launch","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-29T14:08:41.173201-08:00","created_by":"ehmo","updated_at":"2026-01-29T14:10:38.13767-08:00","closed_at":"2026-01-29T14:10:38.13767-08:00","close_reason":"Closed"}
{"id":"VAULT-l71","title":"Ensure PBKDF2 runs off Main Actor","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T14:08:40.978949-08:00","created_by":"ehmo","updated_at":"2026-01-29T14:09:59.090786-08:00","closed_at":"2026-01-29T14:09:59.090786-08:00","close_reason":"Closed"}
{"id":"VAULT-lw8","title":"WS5: Toast notification system","status":"closed","priority":1,"issue_type":"feature","owner":"r@turek.co","created_at":"2026-02-08T23:07:36.915488-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:10:53.120985-08:00","closed_at":"2026-02-08T23:10:53.120985-08:00","close_reason":"Closed"}
{"id":"VAULT-mia","title":"Fix: Wipe counter returns .hashValue instead of raw Int32","description":"SecureEnclaveManager.getWipeCounter() reads 4 bytes as Int32 then calls .hashValue, returning a hash instead of the counter value. The wipe counter is non-functional as an incrementing counter. Fix: remove .hashValue, return the raw Int32. Low effort.","status":"closed","priority":0,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-17T20:36:18.098393-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:45:17.438228-08:00","closed_at":"2026-02-17T20:45:17.438228-08:00","close_reason":"Closed"}
{"id":"VAULT-mjp","title":"Parallelize file re-encryption in share upload","description":"BackgroundShareTransferManager:87-112 processes files sequentially. Use withTaskGroup to parallelize file reads + re-encryption, then collect results in order. Keep progress reporting per-file.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-01T16:40:25.344386-08:00","created_by":"ehmo","updated_at":"2026-02-01T16:42:26.737414-08:00","closed_at":"2026-02-01T16:42:26.737414-08:00","close_reason":"Replaced sequential for-loop with withThrowingTaskGroup for concurrent file read+re-encrypt. Results collected and sorted by original index for deterministic output."}
{"id":"VAULT-mn7","title":"Audit and fix critical try? silent error paths","description":"SecureEnclaveManager.getBlobCursorXORKey falls back to zeros silently. VaultView.deleteFile uses try? losing errors. Audit all try? in security paths.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:00:47.965535-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:47:31.975828-08:00","closed_at":"2026-02-11T22:47:31.975828-08:00","close_reason":"Closed"}
{"id":"VAULT-ngi","title":"Add accessibility labels to all interactive elements","description":"Zero accessibilityLabel/Hint/Value modifiers in entire codebase. Icon-only buttons read SF Symbol names. Pattern grid unusable with VoiceOver. Progress indicators convey nothing to screen readers.","status":"closed","priority":0,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-01T15:10:08.419435-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:12:37.070398-08:00","closed_at":"2026-02-01T15:12:37.070398-08:00","close_reason":"Added accessibility labels to: VaultView toolbar buttons (settings, lock), shared vault update button, add files button, photo grid items, file grid items, pattern lock view (decorative icon hidden, recovery/join hints), pattern grid (label, hint, value), onboarding progress indicators, camera controls (flash, capture, flip), full screen viewer actions button, change pattern progress indicator, recovery phrase reveal button, empty state decorative icon hidden, feature row combined elements"}
{"id":"VAULT-nh1","title":"Perf: Cache decrypted VaultIndex in memory — eliminate decrypt per file view","description":"VaultStorage.retrieveFile() calls loadIndex() on every invocation: reads file from disk, AES-GCM decrypts, JSON-decodes all entries. Swiping 20 photos = 20 full index decrypt+decode cycles. Fix: cache decrypted VaultIndex keyed by key fingerprint; invalidate only on saveIndex(). Index is already loaded at unlock time. VaultStorage.swift:969-983.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:37:16.662143-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:15:59.125363-08:00","closed_at":"2026-02-17T21:15:59.125363-08:00","close_reason":"Closed"}
{"id":"VAULT-nnt","title":"Refactor: VaultStorage @MainActor annotation — replace NSRecursiveLock","description":"VaultStorage explicitly opts out of Swift actor isolation, uses NSRecursiveLock. Multiple managers call loadIndex/saveIndex concurrently. Fix: annotate VaultStorage as @MainActor — simplest safe path for iOS app where all storage writes are triggered by user actions. Prerequisite: complete VaultIndexManager extraction.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:37:28.908606-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:18:36.157422-08:00","closed_at":"2026-02-17T22:18:36.157422-08:00","close_reason":"Deferred — @MainActor migration requires making all 49 loadIndex/saveIndex call sites async plus 15 internal VaultStorage methods. NSRecursiveLock works correctly. VaultIndexManager extraction (VAULT-fat) was the real prerequisite.","dependencies":[{"issue_id":"VAULT-nnt","depends_on_id":"VAULT-fat","type":"blocks","created_at":"2026-02-17T20:38:44.958785-08:00","created_by":"ehmo"}]}
{"id":"VAULT-nvx","title":"Tests: VaultFullChainTests — pattern → key derivation → store → retrieve → verify","description":"No test exercises the full chain: draw pattern → PatternSerializer → KeyDerivation (PBKDF2) → VaultStorage.loadIndex → storeFile → retrieveFile → verify original bytes. Write VaultFullChainTests: known pattern, deriveKey, store 3 files, retrieve and compare, change pattern, verify files still accessible. Medium effort.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:36:51.838654-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:12:52.64505-08:00","closed_at":"2026-02-17T21:12:52.64505-08:00","close_reason":"Closed"}
{"id":"VAULT-ofa","title":"Add unit test target + initial test coverage for sharing/crypto","description":"No test files exist in the project. Add XCTest target and initial coverage for: SVDFSerializer (pure functions), ShareSyncCache (file-based, use temp dirs), CryptoEngine round-trips, SharedVaultData.decode (plist vs JSON auto-detect). These are the highest-value, lowest-friction test targets.","status":"closed","priority":3,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-10T00:58:42.843552-08:00","created_by":"ehmo","updated_at":"2026-02-10T01:27:28.970484-08:00","closed_at":"2026-02-10T01:27:28.970484-08:00","close_reason":"Implemented VaultTests target with 32 tests across 4 suites (CryptoEngine, SVDF, ShareSyncCache, SharedVaultData). All pass."}
{"id":"VAULT-per","title":"Perf: Replace encryptedThumbnails [UUID:Data] with NSCache — unbounded memory growth","description":"ThumbnailCache.swift:7: encryptedThumbnails is a plain [UUID:Data] dictionary with no eviction policy. NSCache (the image cache) has memory limits; the encrypted source data does not. 500 files × 50KB thumbnails = ~25MB permanently pinned. Fix: replace with NSCache\u003cNSUUID, NSData\u003e with a ~8MB byte cost limit.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:37:51.416894-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:23:42.104862-08:00","closed_at":"2026-02-17T21:23:42.104862-08:00","close_reason":"Closed"}
{"id":"VAULT-pzr","title":"Bug: TOCTOU race in ImportIngestor — force-unwrap after nil check","description":"ImportIngestor.processBatch: file URL is nil-checked at line 118-124 then re-fetched with force-unwrap at line 136. Orphan cleanup running concurrently could delete the file between check and use. Fix: fetch URL once with guard let, hold the URL variable through the entire operation. ImportIngestor.swift:118-136.","status":"closed","priority":1,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-17T20:37:03.379774-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:53:35.95724-08:00","closed_at":"2026-02-17T20:53:35.95724-08:00","close_reason":"Closed"}
{"id":"VAULT-q98","title":"Eliminate duplicate loadIndex on vault appear","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T14:08:40.785016-08:00","created_by":"ehmo","updated_at":"2026-01-29T14:09:43.286013-08:00","closed_at":"2026-01-29T14:09:43.286013-08:00","close_reason":"Closed"}
{"id":"VAULT-qgz","title":"Add haptic feedback to pattern grid and key interactions","description":"Zero haptic feedback anywhere. Pattern grid needs UISelectionFeedbackGenerator on dot hit, UINotificationFeedbackGenerator on unlock success/failure. Also needed on destructive confirmations.","status":"closed","priority":0,"issue_type":"feature","owner":"r@turek.co","created_at":"2026-02-01T15:10:11.154445-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:15:57.661586-08:00","closed_at":"2026-02-01T15:15:57.661586-08:00","close_reason":"Added haptic feedback: UISelectionFeedbackGenerator on each dot hit in PatternGridView, UINotificationFeedbackGenerator(.warning) on pattern too short, (.error) on unlock fail, (.success) on unlock success in PatternLockView, (.success) on valid pattern and match in PatternSetupView, (.error) on pattern mismatch in PatternSetupView."}
{"id":"VAULT-rd8","title":"Perf: Group FileHandles by blob in storeFiles() batch","description":"VaultStorage.storeFiles() opens+closes a new FileHandle per file in the loop. 100 batch imports = 100 kernel open/close syscalls. deleteFiles() already groups by blob and reuses handles. Mirror that pattern in storeFiles().","status":"open","priority":3,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:23.531621-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:38:23.531621-08:00"}
{"id":"VAULT-rlu","title":"Extract VaultView child views via extensions","description":"VaultView.swift is 1746 lines with 15+ responsibilities. Extract ImportManager, BatchOperations, SharedVaultSync into separate files via extensions.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:00:40.646197-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:47:31.97833-08:00","closed_at":"2026-02-11T22:47:31.97833-08:00","close_reason":"Closed"}
{"id":"VAULT-rtd","title":"Extract shared PatternValidationFeedbackView component","description":"validationFeedback() is copy-pasted across PatternSetupView, ChangePatternView, SharedVaultInviteView, JoinVaultView. Extract to shared component in UI/Components/.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:00:46.642353-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:28:19.161189-08:00","closed_at":"2026-02-11T22:28:19.161189-08:00","close_reason":"Closed"}
{"id":"VAULT-s8x","title":"Tests: ShareUploadManagerTests — job lifecycle, persistence, cancellation","description":"ShareUploadManager core flow is untested: job creation, status transitions (pending→uploading→complete/failed), persistence across app restarts, resume-after-crash, cancellation. Write tests using mock CloudKitSharingClient. Prerequisite: protocol extraction (VAULT-esf).","status":"in_progress","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:02.858278-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:29:02.83641-08:00","dependencies":[{"issue_id":"VAULT-s8x","depends_on_id":"VAULT-esf","type":"blocks","created_at":"2026-02-17T20:38:44.751238-08:00","created_by":"ehmo"}]}
{"id":"VAULT-s9o","title":"Increase pattern grid node touch targets to 44pt","description":"PatternGridView.swift nodeRadius is 16pt (32pt diameter), below 44pt HIG minimum. Visual nodes hard to target on iPhone SE. Also PatternLockView bottom buttons (recovery phrase, join shared vault) are small text-only buttons with no explicit frame.","status":"closed","priority":1,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-01T15:10:16.128013-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:17:37.445604-08:00","closed_at":"2026-02-01T15:17:37.445604-08:00","close_reason":"Increased pattern grid hit area to max(nodeRadius*1.5, 22pt) ensuring 44pt minimum diameter. Added minHeight: 44 to 'Use recovery phrase' and 'Join shared vault' buttons on lock screen."}
{"id":"VAULT-srs","title":"Perf: Route large file retrieval through retrieveFileToTempURL (2x memory peak fix)","description":"VaultStorage.retrieveFileContent() loads entire encrypted file into Data, then decrypted into Data — 2x peak for 50MB video = 100MB. retrieveFileToTempURL() exists with streaming decryption. Audit call sites in FullScreenPhotoViewer and SecureImageViewer — route video and large files through the streaming path. Images under threshold stay in-memory.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:02.592125-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:23:42.122368-08:00","closed_at":"2026-02-17T21:23:42.122368-08:00","close_reason":"Closed"}
{"id":"VAULT-t5u","title":"WS3: Vault door unlock transition","status":"closed","priority":2,"issue_type":"feature","owner":"r@turek.co","created_at":"2026-02-08T23:11:01.282373-08:00","created_by":"ehmo","updated_at":"2026-02-08T23:12:47.391355-08:00","closed_at":"2026-02-08T23:12:47.391355-08:00","close_reason":"Closed"}
{"id":"VAULT-ui8","title":"Perf: computeVisibleFiles() runs on every SwiftUI body evaluation","description":"VaultView.swift:215: computeVisibleFiles() (filter+sort+dict build, O(n log n)) runs on every body evaluation including fan menu open, search keystrokes, and import progress updates. Fix: cache as @State var visibleFiles, recompute only with onChange on files/searchText/sortOrder/filter. Immediate UI smoothness improvement for large vaults.","status":"closed","priority":1,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-17T20:37:16.52901-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:06:28.996619-08:00","closed_at":"2026-02-17T21:06:28.996619-08:00","close_reason":"Closed"}
{"id":"VAULT-v8o","title":"Add Dark Mode variant for VaultHighlight color","description":"VaultHighlight (#E45858 coral red) has no dark appearance variant. All other custom colors have dark variants. Used extensively for errors/warnings/destructive actions. May have poor contrast in Dark Mode.","status":"closed","priority":1,"issue_type":"bug","owner":"r@turek.co","created_at":"2026-02-01T15:10:12.581931-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:16:23.36766-08:00","closed_at":"2026-02-01T15:16:23.36766-08:00","close_reason":"Added dark appearance variant for VaultHighlight: light=#E45858 (coral red), dark=#FF6F6F (brighter coral) for better contrast against dark backgrounds. Now consistent with all other custom colors having both variants."}
{"id":"VAULT-vmn","title":"Tests: DuressHandlerTests — P0 security, zero coverage","description":"DuressHandler has zero unit tests. triggerDuress() destroys all vault indexes except duress vault — a bug here is either a security failure (fails to destroy) or data loss (destroys duress vault). Write full suite: setAsDuressVault, isDuressKey, clearDuressVault, hasDuressVault, triggerDuress (verify non-duress indexes deleted, duress vault intact), destroyAllNonDuressData. Use real temp directories.","status":"closed","priority":0,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:36:42.254736-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:49:42.693161-08:00","closed_at":"2026-02-17T20:49:42.693161-08:00","close_reason":"Closed"}
{"id":"VAULT-vun","title":"Refactor: DRY — extract updateManifestRecord() in CloudKitSharingManager","description":"CloudKitSharingManager.swift:207-218, 262-275, 314-327: query manifest by shareVaultId → iterate matchResults → update version/updatedAt/chunkCount → save. Copied 3 times across syncSharedVault(), syncSharedVaultIncremental(), syncSharedVaultIncrementalFromFile(). Extract updateManifestRecord(shareVaultId:chunkCount:version:) async throws private helper.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:37:40.303466-08:00","created_by":"ehmo","updated_at":"2026-02-17T21:21:32.115903-08:00","closed_at":"2026-02-17T21:21:32.115903-08:00","close_reason":"Closed"}
{"id":"VAULT-whd","title":"Remove optional:true from non-pattern Maestro assertions","description":"Nearly every Maestro assertion uses optional:true making tests pass trivially. Remove from button/text/navigation assertions, keep only for PatternGridView interactions.","status":"closed","priority":2,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:01:04.154343-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:28:19.162444-08:00","closed_at":"2026-02-11T22:28:19.162444-08:00","close_reason":"Closed"}
{"id":"VAULT-x68","title":"Replace debug prints with structured os.log","description":"~80+ #if DEBUG print() blocks with emoji. App already uses Logger in iCloudBackupManager. Extend pattern to rest of codebase. Some prints leak key hashes.","status":"closed","priority":3,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:00:50.606694-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:47:31.979538-08:00","closed_at":"2026-02-11T22:47:31.979538-08:00","close_reason":"Closed"}
{"id":"VAULT-xp7","title":"Perf: listFiles() N+1 thumbnail decryptions — replace with listFilesLightweight() in VaultSettingsView","description":"VaultStorage.listFiles() decrypts all thumbnails in a tight loop — 500 AES-GCM ops on settings screen load. listFilesLightweight() was added to avoid this. Replace the listFiles() call in VaultSettingsView with listFilesLightweight(). Deprecate the thumbnail-decrypting overload.","status":"open","priority":3,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:23.776924-08:00","created_by":"ehmo","updated_at":"2026-02-17T20:38:23.776924-08:00"}
{"id":"VAULT-xqp","title":"Perf: Debounce redundant loadVault/loadFiles calls in VaultView","description":"VaultView.swift has 3 non-debounced triggers that each call loadVault()/loadFiles() (full index decrypt). Settings dismiss + import complete within 1s triggers two concurrent loads. Fix: debounce with 0.1s, cancel prior in-flight Task.","status":"in_progress","priority":3,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-17T20:38:34.84003-08:00","created_by":"ehmo","updated_at":"2026-02-17T22:31:35.108307-08:00"}
{"id":"VAULT-yd5","title":"Copy-and-mutate VaultIndex in changeVaultKey","description":"changeVaultKey manually copies all VaultIndex fields (fragile). Replace with var newIndex = index; newIndex.encryptedMasterKey = newEncryptedMasterKey.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:00:52.425093-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:04:43.404751-08:00","closed_at":"2026-02-11T22:04:43.404751-08:00","close_reason":"Closed"}
{"id":"VAULT-yw0","title":"Write-ahead pattern for changeVaultKey","description":"VaultStorage.changeVaultKey saves new index then deletes old. Crash between = data loss. Save new, verify reads back, then delete old.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:00:45.186778-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:22:12.408417-08:00","closed_at":"2026-02-11T22:22:12.408417-08:00","close_reason":"Implemented write-ahead pattern: temp file -\u003e verify -\u003e atomic move -\u003e delete old. Stale .tmp files cleaned on init."}
{"id":"VAULT-zgs","title":"Set large title display mode on root VaultView","description":"VaultView uses .navigationTitle(appState.vaultName) but doesn't specify .navigationBarTitleDisplayMode(.large). HIG requires large titles on primary/root views.","status":"closed","priority":1,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-01T15:10:17.70364-08:00","created_by":"ehmo","updated_at":"2026-02-01T15:18:05.834054-08:00","closed_at":"2026-02-01T15:18:05.834054-08:00","close_reason":"Added .navigationBarTitleDisplayMode(.large) to VaultView. Root view now shows large title per HIG Rule 2.3, transitioning to inline on scroll."}
{"id":"VAULT-zhw","title":"Stream-encrypt iCloud backup using CryptoEngine.encryptStreaming","description":"CRITICAL: performBackup loads entire 500MB blob into memory causing OOM crash. Use existing encryptStreaming API to process in 256KB chunks via FileHandle.","status":"closed","priority":0,"issue_type":"task","owner":"r@turek.co","created_at":"2026-02-11T22:01:07.685103-08:00","created_by":"ehmo","updated_at":"2026-02-11T22:47:31.974297-08:00","closed_at":"2026-02-11T22:47:31.974297-08:00","close_reason":"Closed"}
